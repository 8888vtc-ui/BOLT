Salut Opus â€” bug critique corrigÃ© : doubles non jouÃ©s correctement

ğŸ ProblÃ¨me
Quand un double est lancÃ© (ex: [1,1,1,1]), le systÃ¨me ne permettait qu'un seul mouvement au lieu de 4.

ğŸ” Cause
Dans src/board/utils/mappers.ts ligne 272-273, la logique utilisait seulement [dice[0], dice[1]] au lieu de tous les 4 dÃ©s.

Code dÃ©fectueux:
if (gameState.dice.length === 4) {
    diceForMoves = [gameState.dice[0], gameState.dice[1]]; // âŒ 2 dÃ©s seulement
}

âœ… Correctif appliquÃ©
Fichier: src/board/utils/mappers.ts

Correction:
if (gameState.dice.length === 4) {
    diceForMoves = [...gameState.dice]; // âœ… Tous les 4 dÃ©s
}

AmÃ©liorations aussi dans src/hooks/useGameSocket.ts:
- Meilleure dÃ©tection du dÃ© Ã  consommer
- Logs dÃ©taillÃ©s pour debug doubles

ğŸ¯ Comportement attendu
Pour un double 1 [1,1,1,1]:
1. Calcul legal moves avec 4 dÃ©s â†’ 4 mouvements possibles
2. Premier mouvement â†’ Consomme 1 dÃ©, reste [1,1,1]
3. Recalcul avec [1,1,1] â†’ 3 mouvements possibles
4. DeuxiÃ¨me mouvement â†’ Consomme 1 dÃ©, reste [1,1]
5. TroisiÃ¨me mouvement â†’ Consomme 1 dÃ©, reste [1]
6. QuatriÃ¨me mouvement â†’ Consomme 1 dÃ©, reste []
7. Fin du tour â†’ Changement de tour

ğŸ§ª Tests Ã  effectuer
1. Lancer jusqu'Ã  obtenir un double 1
2. VÃ©rifier que 4 mouvements sont possibles
3. Jouer les 4 mouvements consÃ©cutivement
4. VÃ©rifier que le tour change seulement aprÃ¨s le 4Ã¨me mouvement
5. Tester aussi avec double 6
6. VÃ©rifier que les non-doubles fonctionnent toujours

ğŸ“‹ Action requise
1. VÃ©rifier que les corrections sont correctes
2. Tester avec un double 1 pour confirmer
3. VÃ©rifier que les non-doubles fonctionnent toujours
4. Tester avec le bot pour s'assurer qu'il joue correctement les doubles

Le correctif devrait permettre de jouer les 4 mouvements d'un double correctement.

Merci ! ğŸ²

